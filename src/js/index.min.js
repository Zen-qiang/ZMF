"use strict";var queue,animationEnd=function(e){var t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var a in t)if(void 0!==e.style[a])return t[a]}(document.createElement("div")),preLoad=function(){(queue=new createjs.LoadQueue(!1)).loadManifest([{id:"box1",src:"box_green.svg"}],!0,"image/"),queue.on("progress",loadFileProgress),queue.on("complete",loadComplete)};function loadComplete(e){console.log("已加载完毕全部资源"),bgAnimate()}function loadFileProgress(e){console.log("已加载 "+(100*queue.progress|0)+"%"),$(".loading_text").text((100*queue.progress|0)+"%")}function bgAnimate(){var e=$(".h_bg");$(".h_loading").remove(),$(".h_head").remove(),$("img").each(function(){$(this).attr("src",$(this).attr("data-src")).removeAttr("data-src")}),e.addClass("box_enter"),setTimeout(function(){e.removeClass("box_enter").addClass("box_shake")},600),setTimeout(function(){pageplay(".page7")},800)}function pageplay(e){$(e).siblings().css("display","none").end().css("display","block")}$("body").height($(window).height()),$(".page1 .go").on("touchstart",function(){var e=$(".page1 input").val();e&&pageplay(".page2"),$(".user").text(e)}),$(".page2 .go").on("click",function(){pageplay(".page3")}),$(".page3 .go").on("click",function(){pageplay(".page4")}),$(".page4 .go").on("click",function(){pageplay(".page5"),mask_square()}),$(".page6 .go").on("click",function(){pageplay(".page7")}),$(".page7 .go").on("click",function(){pageplay(".page8")}),$(".take_gift .next").on("click",function(){$(".take_gift").addClass("active"),setTimeout(function(){$(".take_gift").css("display","none"),$(".make").css("display","block")},500)}),$(".page8 .share").on("click",function(){pageplay(".page9")});var actorNo=0,actor_timer=null;function marquee(){var e=0,t=setInterval(function(){e++,$(".page5 .bg").toggleClass("active"),9==e&&(clearInterval(t),pageplay(".page6"))},160)}function mask_square(){var e=0,t=0,a=setInterval(function(){29==e?(e=0,t++):e++,2==t?3==e||6==e||20==e?$(".page5 .mask_square span").eq(e).addClass("active"):$(".page5 .mask_square span").eq(e).addClass("active").end().eq(e-1).removeClass("active"):3==t?(clearInterval(a),marquee()):$(".page5 .mask_square span").eq(e).addClass("active").end().eq(e-1).removeClass("active")},70)}$(".page3 .actor").on("click",function(){3<=$(".page3 .actor.active").length||($(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active"),3==$(".page3 .actor.active").length&&($(".page3 .logo").addClass("active"),setTimeout(function(){pageplay(".page4"),$(".page3 .logo").removeClass("active"),$(".page3 .actor").removeClass("active")},1e3)))}),$(".page7 .diy_element li").on("click",function(){var e=$(this).index();$(this).addClass("active").siblings().removeClass("active"),$(".diy_element .labels > div").eq(e).addClass("active").siblings().removeClass("active")}),$(".page7 .diy_right li").on("click",function(){if(!$(this).hasClass("active")){var e=$(this).index()+1,t=$(".diy_bg img").attr("src").split(".png")[0].slice(0,-1);$(this).addClass("active").siblings().removeClass("active"),$(".diy_bg img").attr("src",t+e+".png")}});var ZMF=(document,{copyDom:null,events:function(){$(".page7 .labels img").on({touchstart:this.diyStart,touchmove:this.diyMove,touchend:this.diyEnd}),this.createRandom()},diyStart:function(e){e.preventDefault(),e.stopPropagation();var t=ZMF,a=$(this)[0].getBoundingClientRect(),n={width:a.width+"px",height:a.height+"px",left:a.left+"px",top:a.top+"px"};t.copyDom=$(this).clone().css(n).appendTo(".page7")},diyMove:function(e){e.preventDefault(),e.stopPropagation();var t=ZMF,a=e.originalEvent.targetTouches[0],n=parseInt(t.copyDom.css("width"))/2,o=parseInt(t.copyDom.css("height"))/2,i=a.pageX-n+"px",s=a.pageY-o+"px";t.copyDom.css({left:i,top:s})},diyEnd:function(e){e.preventDefault(),e.stopPropagation();var t=ZMF,a=$(".page7 .diy_left .diy_content")[0].getBoundingClientRect(),n=t.copyDom[0].getBoundingClientRect(),o=t.copyDom.attr("class"),i=a.top<=n.top,s=a.left<=n.left,c=a.right>=n.right,g=a.bottom>=n.bottom,l=parseInt(t.copyDom.css("left"))-a.left+"px",p=parseInt(t.copyDom.css("top"))-a.top+"px";t.isScale=!1,i&&s&&c&&g?($(".page7 .diy_content").children("."+o).remove(),t.copyDom.appendTo($(".page7 .diy_content")).css({left:l,top:p}),t.setScale()):t.copyDom.remove()},getDistance:function(e,t){var a=t.pageX-e.pageX,n=t.pageY-e.pageY;return Math.sqrt(a*a+n*n)},setScale:function(){var p=ZMF,e=$(".page7 .diy_left .diy_content"),r=[],d=!0;e.on("touchstart",function(e){2<=e.originalEvent.touches.length?r=e.originalEvent.touches:e.preventDefault()}),e.on("touchmove",function(e){if(d){d=!1,setTimeout(function(){d=!0},60);var t=e.originalEvent.touches;if(2<=t.length){var a=t,n=(p.getDistance(a[0],a[1])/p.getDistance(r[0],r[1])).toFixed(2);p.copyDom.css("transform","scale("+n+")")}else if(1==t.length&&"IMG"==t[0].target.tagName){var o=$(t[0].target),i=$(this)[0].getBoundingClientRect(),s=parseInt(o.css("width"))/2,c=parseInt(o.css("height"))/2,g=t[0].pageX-s-i.left+"px",l=t[0].pageY-c-i.top+"px";o.css({left:g,top:l})}else e.preventDefault()}})},convert2canvas:function(){var e=$(".page9 .container")[0],t=$(".page9 .container").width(),a=$(".page9 .container").height(),n=document.createElement("canvas");n.width=2*t,n.height=2*a,n.getContext("2d").scale(2,2);var o={scale:2,canvas:n,width:t,height:a,useCORS:!0};console.log(o),html2canvas(e,o).then(function(e){var t=e.getContext("2d");t.mozImageSmoothingEnabled=!1,t.webkitImageSmoothingEnabled=!1,t.msImageSmoothingEnabled=!1,t.imageSmoothingEnabled=!1;var a=Canvas2Image.convertToPNG(e,e.width,e.height);$(".page9").append(a),$(a).css({width:e.width/2+"px",height:e.height/2+"px"}).addClass("f-full")})},createRandom:function(){}});ZMF.events();